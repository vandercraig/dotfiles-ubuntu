#!/usr/bin/env bash
# Auto-install pre-commit hooks when entering repo

# Install pre-commit if not found
if ! command -v pre-commit &> /dev/null; then
    if command -v uv &> /dev/null; then
        echo "üì¶ Installing pre-commit via uv..."
        uv tool install pre-commit
        echo "‚úì pre-commit installed"
    else
        echo "‚ùå Error: uv not found. Please run ansible playbook first."
        return 1
    fi
fi

# Install hooks if not already done
if [ -f .pre-commit-config.yaml ] && [ ! -f .git/hooks/pre-commit ]; then
    echo "üîß Installing pre-commit hooks..."
    pre-commit install
    echo "‚úì Pre-commit hooks installed"
fi

# Environment setup
export DOTFILES_ROOT="$PWD"
export ANSIBLE_CONFIG="$PWD/ansible/ansible.cfg"
PATH_add "$HOME/.local/bin"

echo "‚úì Dotfiles environment loaded"
